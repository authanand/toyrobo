#!/usr/bin/env node
/*! toyrobo 2018-12-15 */

var fs=require("fs");ToyRobo=require("./src/toyrobo.js"),chalk=require("chalk"),byline=require("byline");var inputArray=[];function bootsrap(){var t=new ToyRobo;(2==process.argv.length?process.argv[2]:fs.createReadStream(process.argv[2])).on("error",function(o){console.log("Can't open file.")});var o=byline(fs.createReadStream(process.argv[2],{encoding:"utf8"}));o.on("data",function(o){inputArray.push(o)}),o.on("end",function(o){t.loadData(inputArray)})}function ToyRobo(){this.placed=!1,this.x=null,this.y=null,this.face=null,this.faceMap={north:{value:"north",left:"west",right:"east"},east:{value:"east",left:"north",right:"south"},south:{value:"south",left:"east",right:"west"},west:{value:"west",left:"south",right:"north"}}}bootsrap(),ToyRobo.prototype.loadData=function(o){if(o)for(var t=0;t<o.length;t++)0<=o[t].indexOf("PLACE")?this.placeRobot(o,t):"report"==o[t].toLowerCase()?this.report():"move"==o[t].toLowerCase()?this.move():this.turn(o[t].toLowerCase())},ToyRobo.prototype.placeRobot=function(o,t){o=(o=o.map(function(o){return o.replace("PLACE ","")}))[t].split(","),void 0!==this.faceMap[o[2].toLowerCase()]&&0<=parseInt(o[0])&&parseInt(o[0])<=4&&0<=parseInt(o[1])&&parseInt(o[1])<=4&&(this.x=parseInt(o[0]),this.y=parseInt(o[1]),this.placed=!0,this.face=o[2].toLowerCase(),console.log("Robot placed: "+this.x+", "+this.y+", "+this.face.toUpperCase()))},ToyRobo.prototype.report=function(){this.placed?(console.log(chalk.yellow("##########################################################")),console.log(chalk.green("Report: "+this.x+", "+this.y+", "+this.face.toUpperCase())),console.log(chalk.yellow("##########################################################"))):console.log(chalk.red("Robot is not placed"))},ToyRobo.prototype.move=function(){switch(this.face){case"north":this.y+1<=4&&this.y++;break;case"east":this.x+1<=4&&this.x++;break;case"south":0<=this.y-1&&this.y--;break;case"west":0<=this.x-1&&this.x--}console.log("Robot moved: "+this.x+", "+this.y)},ToyRobo.prototype.turn=function(o){if(this.placed){var t=this.faceMap[this.face][o];t&&(this.face=t),console.log("Robot current direction: "+this.face.toUpperCase())}},module.exports=ToyRobo;